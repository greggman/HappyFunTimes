<!DOCTYPE html>
<!-- this file is auto-generated from docs/unity/player-connect.md. Do not edited directly -->
<!--
Copyright 2012, Gregg Tavares.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    * Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above
copyright notice, this list of conditions and the following disclaimer
in the documentation and/or other materials provided with the
distribution.
    * Neither the name of Gregg Tavares. nor the names of his
contributors may be used to endorse or promote products derived from
this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, user-scalable=yes">
    <meta property="og:title" content="Spawning Players"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="http://docs.happyfuntimes.net/docs/images/happyfuntimes.jpg"/>
    <meta property="og:description" content="What happens when a player joins"/>
    <meta property="og:url" content="http://docs.happyfuntimes.net/docs/unity/player-connect.html"/>

    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@greggman"/>
    <meta name="twitter:creator" content="@greggman"/>
    <meta name="twitter:domain" content="docs.happyfuntimes.net"/>
    <meta name="twitter:title" content="Spawning Players"/>
    <meta name="twitter:url" content="http://docs.happyfuntimes.net/docs/unity/player-connect.html"/>
    <meta name="twitter:description" content="What happens when a player joins"/>
    <meta name="twitter:image:src" content="http://docs.happyfuntimes.net/docs/images/happyfuntimes.jpg"/>

    <title>Spawning Players</title>

    <link href="/public/hft-icon.png" rel="shortcut icon" type="image/png">
    <link rel="stylesheet" href="/docs/assets/css/styles.css" type="text/css"/>
</head>
<body>

<div class="header">
  <h1><a href="/docs/unity">HappyFunTimes Docs</a></h1>
</div>



<div class="container">

    <div class="docs-title">
        <h1>Spawning Players</h1>
    </div>

    <div class="row">
        <div class="col-xs-12 col-lg-8 docs-content">

            <p>It&#39;s probably easies to start with a working example but from scratch
here are the steps.</p>
<p>The easiest thing to do when a player joins your HappyFunTimes game
is to spawn a prefab. To do this</p>
<ol>
<li><p>Make new <code>GameObject</code></p>
<p><img src="images/create-game-object.png" class="halfsize lesson" /></p>
<p>name it something like &quot;PlayerCreator&quot; to help you remember
what it&#39;s doing.</p>
<p><img src="images/name-gameobject.png" class="halfsize lesson" /></p>
</li>
<li><p>Click <code>Add Component</code> and then pick <code>HappyFunTimes-&gt;PlayerSpawner</code></p>
<p><img src="images/hft-components.png" class="halfsize lesson" /></p>
<p><img src="images/hft-playerspawner-script.png" class="halfsize" /></p>
</li>
<li><p>Select the prefab you want HappyFunTimes to birth each time
a player connects</p>
<p><img src="images/playerspawner.png" class="halfsize lesson" /></p>
</li>
</ol>
<p><strong>NOTE: There can only be one <code>PlayerSpawner</code> script in your scene</strong></p>
<p>At this point, assuming you have a <a href="self-control.html">working controller</a>, if you
run your game and open some browser windows to <code>http://localhost:18679</code> you should
see your prefab being spawned. Of course it won&#39;t do anything yet.</p>
<h2 id="making-your-player-respond-to-input">Making your player respond to input</h2>
<p>In your prefab pick <code>Add Component-&gt;New Script</code></p>
<p><img src="images/new-script.png" class="halfsize lesson" /></p>
<p>and name it something like <code>PlayerControl</code></p>
<p><img src="images/playercontrol-script.png" class="halfsize lesson" /></p>
<p><a href="basics.html#how-it-works">Then follow the code on this page</a></p>
<h2 id="controlling-gameobjects-already-in-the-scene">Controlling GameObjects already in the scene</h2>
<p>HappyFunTimes is designed to support 10s, or even 100s of players
but sometimes you just want to use it for a fixed number of
players of GameObjects manually placed in the scene to use the phone
as a controller.</p>
<p>The easist way to do this is to use the HappyFunTimes PlayerConnector
script.</p>
<ol>
<li><p>Make new <code>GameObject</code></p>
<p><img src="images/create-game-object.png" class="halfsize lesson" /></p>
<p>name it something like &quot;PlayerManager&quot; to help you remember
what it&#39;s doing.</p>
<p><img src="images/name-gameobject.png" class="halfsize lesson" /></p>
</li>
<li><p>Click <code>Add Component</code> and then pick <code>HappyFunTimes-&gt;PlayerConnectorr</code></p>
<p><img src="images/hft-components.png" class="halfsize lesson" /></p>
<p><img src="images/hft-playerconnector-script.png" class="halfsize lesson" /></p>
</li>
<li><p>Open the player property and set the size to the number of players
you support, then drag in each of your player GameObjects into the
slots <code>Element 0</code>, <code>Element 1</code> etc.</p>
<p><img src="images/playerconnector.png" class="halfsize lesson" /></p>
<p>The first person to connect to your game will control the GameObject
in the first slot, the second player to connect to your game will
control the GameObject in the second slot etc ...</p>
<p>Making your players respond to input is <a href="#making-your-player-respond-to-input">the same as above</a>.</p>
<p>Let&#39;s say your game supports 3 people and 6 people try to connect. The first 3
people will control the 3 GameObjects you setup. Their <code>InitializeNetPlayer</code>
function will be call. For the next 3 players the <code>WaitingNetPlayer</code> function
will be called <strong>on the same <code>GameObject</code> as the <code>PlayerConnnetor</code></strong>.</p>
<p>If one of the first 3 people disconnects from the game one of the
previously denied people will take their slot. Note: Your GameObject&#39;s
InitializeNetPlayer will be called again. This is so it can pass you a new
<code>NetPlayer</code> object to talk to the new player as wel as receive their name.
It&#39;s up to you if you want to reset any state in the game or just have them
continue from where the previous player left off.</p>
<p>If you&#39;d like a player to be able to reconnect and pick up where they left
off sed the <code>timeout to disconnect</code> setting to how many seconds to give
them to reconnect before giving that slot to a waiting player.</p>
<p>In other words if you set <code>Timeout...</code> set to 15
then a player that disconnects has 15 seconds to reconnect. If they don&#39;t
reconnect in 15 seconds the next available player will take their place.</p>
<p>Just like above making your player repsond to input requires you
add a script to each player and have it have a <code>InitializeNetPlayer</code>
method to receive the <code>NetPlayer</code> for that phone.</p>
<p>You also need to handle waiting players, telling them the game is
full or to wait.</p>
</li>
</ol>
<h4 id="letting-everyone-play">Letting everyone play</h4>
<p>You can <em>return a player</em> by calling <code>PlayerConnector.ReturnPlayer(someNetPlayer)</code>.
You&#39;ll have to get a reference to your <code>PlayerConnector</code>.</p>
<p>What do I mean by <em>return the player</em>?</p>
<p>Imagine you&#39;ve made a game that supports only 4 people. There&#39;s 8 people
who have connected to your game. 4 of them are playing. 4 are waiting to play.
When a player dies you want the next player waiting to start playing. You can
do this by when a player dies calling <code>thePlayerConnector.ReturnPlayer(netPlayerOfPlayerThatDied)</code>.</p>
<p>Similarly let&#39;s say you made a round based game. 7 people are connected
but the game only supports 4 players. You can call <code>thePlayerConnector.FlushCurrentPlayers()</code>
which will effectively call <code>thePlayerConnector.ReturnPlayer(netPlayer)</code> for every currently
connected player and so will swap in the next 4 players.</p>
<h2 id="things-to-be-aware-of">Things to be aware of</h2>
<p>You&#39;ll get an <code>OnDisconnect</code> event (your <code>OnDisconnect</code> callback will be called)
when a player disconnects. When a new player connects whether it&#39;s the same user
who just disconnected or a new user connecting for the first time,
your <code>InitializeNetPlayer</code> function will get called with a new
<code>NetPlayer</code> object.</p>
<p><strong>THE PHONE KEEPS NO STATE!!</strong> This means if you have a controller that changes
modes you need to send whatever messages you&#39;ve created to your controller to
get it in the correct state.</p>
<p>For example, Let&#39;s say have a game with 2 modes. In one mode the phone
shows 3 buttons (yes, no, maybe). In the other mode the phone shows a slingshot.
When the game switches to players needing buttons on their phone or players
needing slingshots on their phone you send a message to them you made up something
like</p>
<pre><code>class ShowControllerMsg {
  ShowControllerMsg(string s) : { control = s; }
  public string control;
};

m_netPlayer.sendCmd(&#39;showcontroller`, new ShowControllerMsg(&quot;slingshot&quot;));
</code></pre><p>A player disconnects, a new player connects, that player is starting in the middle
of the game. Their controller has not received a message that it needs to be showing
the slingshot controls.</p>
<p>So, when your <code>InitializeNetPlayer</code> function gets called you need to send that
message to tell the phone to switch to slingshot mode.</p>


            <div class="docs-footer">

                <div>Found a bug? <a href="http://github.com/greggman/happyfuntimes/issues">Create an issue on Github</a></div>

                <div class="docs-comments">
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_shortname = 'happyfuntimes';
                        var disqus_identifier = 'Spawning Players';
                        var disqus_title = 'Spawning Players';

                        /* * * DON'T EDIT BELOW THIS LINE * * */
                        (function () {
                            if (window.location.hostname.indexOf("happyfuntimes") < 0) {
                                return;
                            }
                            var dsq = document.createElement('script');
                            dsq.type = 'text/javascript';
                            dsq.async = true;
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments
                        powered by Disqus.</a></noscript>
                    <a href="http://disqus.com" class="dsq-brlink">
                        comments powered by <span class="logo-disqus">Disqus</span>
                    </a>
                </div>

            </div>
        </div>

        <div class="col-xs-12 col-lg-4 docs-sidebar">
            <ul class="toc">
    <li>HappyFunTimes & Unity
        <ul>
            <li><a href="getting-started.html">Getting Started</a><span class="hide">: Do this first!</span></li>
            <li><a href="first-game.html">Your First HappyFunTimes Game</a><span class="hide">: Do this second!</span>
            </li>
            <li><a href="gamepad.html">The Sample Gamepad</a><span class="hide">: Read this!</span></li>
            <li><a href="basics.html">How it Works</a><span class="hide">: Read this!</span></li>
        </ul>
    </li>
    <li>Specifics
        <ul>
            <li><a href="player-connect.html">Spawn players</a></li>
            <li><a href="self-control.html">Making controllers (the phone part)</a></li>
            <li><a href="gamepad-sounds.html">Playing sounds on the phone</a></li>
            <li><a href="gamepad-multitouch.html">Handling Multi-Touch</a></li>
        </ul>
    </li>
    <li>Examples
        <ul>
            <li><a href="3d-characters.html">3d Characters</a></li>
            <li><a href="2d-platformer.html">2d Platformer</a></li>
        </ul>
    </li>
    <li>Techinques
        <ul>
            <li><a href="reusing-players.html">Handling disconnect and reconnect</a></li>
            <li><a href="too-many-players.html">Preventing too many players</a></li>
            <li><a href="device-orientation.html">Using Device Orientation</a></li>
            <li><a href="accelerometer.html">Using the Accelerometer</a></li>
            <li><a href="character-selection.html">Spawning different characters per Player</a></li>
            <li><a href="multi-machine.html">Multiple Computers</a></li>
            <li><a href="talking-between-games.html">Talking Between Multiple Computers</a></li>
        </ul>
    </li>
    <li>Sample-UI API Reference
        <ul>
            <li><a href="/docs/hft/">Sample UI (HTML/JavaScript) API</a></li>
        </ul>
    </li>
    <li>Other
        <ul>
            <li><a href="changelog.html">Changelog</a></li>
        </ul>
    </li>
</ul>




        </div>

    </div>
</div>

<script src="/docs/assets/3rdparty/jquery.js"></script>
<script src="/docs/assets/3rdparty/highlight.js"></script>
<script src="/docs/assets/js/lesson.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-51764205-4', 'auto');
  ga('send', 'pageview');
</script>


</body>
</html>



